<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Implementation Guide - Data Engineering Design Patterns</title>
  <link rel="stylesheet" href="./src/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
  <header style="background: #1a1a1a; border-bottom: 1px solid #333; padding: 15px 0;">
    <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center;">
      <div style="display: flex; align-items: center; gap: 15px;">
        <img src="https://avatars.githubusercontent.com/u/145194871?s=280&v=4" alt="DataLab Logo" style="width: 40px; height: 40px; border-radius: 50%;">
        <h1 style="font-size: 1.1rem; color: #fff; font-weight: 600; margin: 0;">Implementation Guide</h1>
      </div>
      <nav style="display: flex; gap: 20px; align-items: center;">
        <a href="index.html" class="nav-link" style="color: #ccc; text-decoration: none; font-size: 0.95rem; padding: 5px 10px; border-radius: 4px;">Home</a>
        <a href="index.html#patterns" class="nav-link" style="color: #ccc; text-decoration: none; font-size: 0.95rem; padding: 5px 10px; border-radius: 4px;">Patterns</a>
        <a href="implementation-guide.html" class="nav-link" style="color: #ccc; text-decoration: none; font-size: 0.95rem; padding: 5px 10px; border-radius: 4px;">Docs</a>
        <a href="https://github.com/DataLabUniSalento" target="_blank" class="nav-link github-link" style="color: #ccc; text-decoration: none; font-size: 0.95rem; padding: 5px 10px; border-radius: 4px; display: flex; align-items: center; gap: 6px;">
          <i class="fab fa-github"></i>
          <span>DataLab</span>
        </a>
      </nav>
    </div>
  </header>

  <main style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
    <!-- Hero Section -->
    <section style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 60px 20px;">
      <div style="max-width: 1200px; margin: 0 auto;">
        <div style="max-width: 800px;">
          <div style="display: inline-block; padding: 4px 12px; background: rgba(255,255,255,0.15); border-radius: 20px; font-size: 0.85rem; margin-bottom: 20px; font-weight: 500;">
            Technical Documentation
          </div>
          <h2 style="font-size: 2.5rem; margin-bottom: 20px; font-weight: 700; line-height: 1.2;">Implementation Guide</h2>
          <p style="font-size: 1.1rem; line-height: 1.7; color: rgba(255,255,255,0.9); margin-bottom: 30px;">
            Comprehensive guides for implementing, customizing, and optimizing the MIND, ETLT/ELTL++, and EADF design patterns in your data engineering projects.
          </p>
        </div>
      </div>
    </section>

    <!-- Pattern Navigation -->
    <section style="padding: 40px; background: #f5f7fa;">
      <div style="max-width: 1200px; margin: 0 auto;">
        <h2 style="text-align: center; margin-bottom: 30px; color: #333;">Choose a Pattern to Implement</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">

          <a href="#mind-guide" style="text-decoration: none;">
            <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-top: 4px solid #667eea; transition: transform 0.3s; cursor: pointer;">
              <div style="text-align: center; margin-bottom: 15px;">
                <i class="fas fa-brain" style="font-size: 3rem; color: #667eea;"></i>
              </div>
              <h3 style="color: #667eea; text-align: center; margin-bottom: 10px;">MIND Pattern</h3>
              <p style="color: #555; text-align: center; line-height: 1.6;">Metadata-driven ingestion framework for handling source heterogeneity</p>
            </div>
          </a>

          <a href="#etlt-guide" style="text-decoration: none;">
            <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-top: 4px solid #9c27b0; transition: transform 0.3s; cursor: pointer;">
              <div style="text-align: center; margin-bottom: 15px;">
                <i class="fas fa-sync-alt" style="font-size: 3rem; color: #9c27b0;"></i>
              </div>
              <h3 style="color: #9c27b0; text-align: center; margin-bottom: 10px;">ETLT/ELTL++</h3>
              <p style="color: #555; text-align: center; line-height: 1.6;">Enhanced transformation patterns with validation framework</p>
            </div>
          </a>

          <a href="#eadf-guide" style="text-decoration: none;">
            <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-top: 4px solid #673ab7; transition: transform 0.3s; cursor: pointer;">
              <div style="text-align: center; margin-bottom: 15px;">
                <i class="fas fa-cloud" style="font-size: 3rem; color: #673ab7;"></i>
              </div>
              <h3 style="color: #673ab7; text-align: center; margin-bottom: 10px;">EADF</h3>
              <p style="color: #555; text-align: center; line-height: 1.6;">Environment-aware deployment with late binding architecture</p>
            </div>
          </a>

        </div>
      </div>
    </section>

    <!-- MIND Implementation Guide -->
    <section id="mind-guide" style="padding: 60px 20px; max-width: 1200px; margin: 0 auto;">
      <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 15px; margin-bottom: 40px;">
        <h2 style="font-size: 2.5rem; margin-bottom: 15px;"><i class="fas fa-brain"></i> MIND Pattern Implementation</h2>
        <p style="font-size: 1.2rem; line-height: 1.8;">Build a scalable, metadata-driven ingestion pipeline that handles diverse data sources without code duplication.</p>
      </div>

      <!-- Architecture Overview -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #667eea; margin-bottom: 20px;"><i class="fas fa-sitemap"></i> Architecture Overview</h3>

        <div style="background: #f5f7fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
          <img src="https://via.placeholder.com/1000x400/667eea/ffffff?text=MIND+Architecture+Diagram" alt="MIND Architecture" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
          <p style="color: #555; line-height: 1.7;">
            The MIND pattern consists of three core components:
          </p>
          <ul style="color: #555; line-height: 1.8; margin-left: 20px;">
            <li><strong>Metadata Repository:</strong> Central table storing source configurations</li>
            <li><strong>Generic Pipeline Engine:</strong> Reads metadata and executes ingestion logic</li>
            <li><strong>Plugin System:</strong> Modular connectors for different source types</li>
          </ul>
        </div>
      </div>

      <!-- Step-by-Step Implementation -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #667eea; margin-bottom: 20px;"><i class="fas fa-list-ol"></i> Step-by-Step Implementation</h3>

        <!-- Step 1 -->
        <div style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-left: 4px solid #667eea; border-radius: 5px;">
          <h4 style="color: #667eea; margin-bottom: 15px;">Step 1: Create the Metadata Table</h4>
          <p style="color: #555; margin-bottom: 15px;">Define a centralized metadata repository to store all source configurations.</p>

          <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;">CREATE TABLE ingestion_metadata (
    source_id VARCHAR(50) PRIMARY KEY,
    data_source VARCHAR(100) NOT NULL,      -- e.g., 'salesforce', 'postgresql'
    table_name VARCHAR(100) NOT NULL,
    connection_string VARCHAR(500),
    credentials_vault_key VARCHAR(100),

    -- Ingestion Configuration
    ingestion_type VARCHAR(20),             -- 'full', 'incremental', 'hybrid'
    primary_key VARCHAR(100),
    watermark_column VARCHAR(100),          -- For incremental loads
    last_watermark TIMESTAMP,

    -- Transformation & Quality
    transformation_script TEXT,
    data_quality_rules JSON,
    partition_strategy VARCHAR(50),

    -- Metadata & Monitoring
    target_table VARCHAR(100),
    target_format VARCHAR(20),              -- 'parquet', 'delta', 'iceberg'
    is_active BOOLEAN DEFAULT TRUE,
    last_run_timestamp TIMESTAMP,
    last_run_status VARCHAR(20),
    record_count_last_run INT,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);</pre>
          </div>

          <div style="margin-top: 15px; padding: 15px; background: #e8f5e9; border-radius: 5px;">
            <p style="color: #2e7d32; margin: 0;"><i class="fas fa-lightbulb"></i> <strong>Tip:</strong> Store sensitive credentials in a vault (Azure Key Vault, AWS Secrets Manager) and reference them by key.</p>
          </div>
        </div>

        <!-- Step 2 -->
        <div style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-left: 4px solid #764ba2; border-radius: 5px;">
          <h4 style="color: #764ba2; margin-bottom: 15px;">Step 2: Build the Generic Pipeline Engine</h4>
          <p style="color: #555; margin-bottom: 15px;">Create a parameterized pipeline that reads metadata and executes ingestion dynamically.</p>

          <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #66d9ef;">import</span> pandas <span style="color: #66d9ef;">as</span> pd
<span style="color: #66d9ef;">from</span> datetime <span style="color: #66d9ef;">import</span> datetime

<span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">MINDPipeline</span>:
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">__init__</span>(self, metadata_db_connection):
        self.metadata_conn = metadata_db_connection
        self.connectors = self._load_connectors()

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">run</span>(self, source_id=<span style="color: #66d9ef;">None</span>):
        <span style="color: #75715e;"># Load active sources from metadata</span>
        query = <span style="color: #e6db74;">"SELECT * FROM ingestion_metadata WHERE is_active = TRUE"</span>
        <span style="color: #66d9ef;">if</span> source_id:
            query += <span style="color: #e6db74;">f" AND source_id = '{source_id}'"</span>

        metadata_rows = pd.read_sql(query, self.metadata_conn)

        <span style="color: #66d9ef;">for</span> idx, config <span style="color: #66d9ef;">in</span> metadata_rows.iterrows():
            <span style="color: #66d9ef;">try</span>:
                self._execute_ingestion(config)
            <span style="color: #66d9ef;">except</span> <span style="color: #a6e22e;">Exception</span> <span style="color: #66d9ef;">as</span> e:
                self._log_failure(config[<span style="color: #e6db74;">'source_id'</span>], <span style="color: #a6e22e;">str</span>(e))

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">_execute_ingestion</span>(self, config):
        <span style="color: #75715e;"># 1. Get appropriate connector</span>
        connector = self.connectors[config[<span style="color: #e6db74;">'data_source'</span>]]

        <span style="color: #75715e;"># 2. Connect to source</span>
        connection = connector.connect(
            config[<span style="color: #e6db74;">'connection_string'</span>],
            config[<span style="color: #e6db74;">'credentials_vault_key'</span>]
        )

        <span style="color: #75715e;"># 3. Extract data based on ingestion type</span>
        <span style="color: #66d9ef;">if</span> config[<span style="color: #e6db74;">'ingestion_type'</span>] == <span style="color: #e6db74;">'incremental'</span>:
            data = self._incremental_extract(connection, config)
        <span style="color: #66d9ef;">else</span>:
            data = self._full_extract(connection, config)

        <span style="color: #75715e;"># 4. Apply transformations</span>
        <span style="color: #66d9ef;">if</span> config[<span style="color: #e6db74;">'transformation_script'</span>]:
            data = self._apply_transformations(data, config[<span style="color: #e6db74;">'transformation_script'</span>])

        <span style="color: #75715e;"># 5. Validate data quality</span>
        <span style="color: #66d9ef;">if</span> config[<span style="color: #e6db74;">'data_quality_rules'</span>]:
            data = self._validate_quality(data, config[<span style="color: #e6db74;">'data_quality_rules'</span>])

        <span style="color: #75715e;"># 6. Load to target</span>
        self._load_data(data, config)

        <span style="color: #75715e;"># 7. Update metadata</span>
        self._update_metadata(config[<span style="color: #e6db74;">'source_id'</span>], <span style="color: #a6e22e;">len</span>(data))</pre>
          </div>
        </div>

        <!-- Step 3 -->
        <div style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-left: 4px solid #9c27b0; border-radius: 5px;">
          <h4 style="color: #9c27b0; margin-bottom: 15px;">Step 3: Implement Source Connectors</h4>
          <p style="color: #555; margin-bottom: 15px;">Create modular connectors for each source type using a plugin architecture.</p>

          <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #66d9ef;">from</span> abc <span style="color: #66d9ef;">import</span> ABC, abstractmethod

<span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">SourceConnector</span>(ABC):
    <span style="color: #a6e22e;">@abstractmethod</span>
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">connect</span>(self, connection_string, credentials_key):
        <span style="color: #66d9ef;">pass</span>

    <span style="color: #a6e22e;">@abstractmethod</span>
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">extract</span>(self, table_name, watermark=<span style="color: #66d9ef;">None</span>):
        <span style="color: #66d9ef;">pass</span>

<span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">SalesforceConnector</span>(SourceConnector):
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">connect</span>(self, connection_string, credentials_key):
        <span style="color: #66d9ef;">from</span> simple_salesforce <span style="color: #66d9ef;">import</span> Salesforce
        creds = self._get_credentials(credentials_key)
        self.sf = Salesforce(
            username=creds[<span style="color: #e6db74;">'username'</span>],
            password=creds[<span style="color: #e6db74;">'password'</span>],
            security_token=creds[<span style="color: #e6db74;">'token'</span>]
        )
        <span style="color: #66d9ef;">return</span> self.sf

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">extract</span>(self, table_name, watermark=<span style="color: #66d9ef;">None</span>):
        query = <span style="color: #e6db74;">f"SELECT * FROM {table_name}"</span>
        <span style="color: #66d9ef;">if</span> watermark:
            query += <span style="color: #e6db74;">f" WHERE LastModifiedDate > {watermark}"</span>
        <span style="color: #66d9ef;">return</span> pd.DataFrame(self.sf.query(query)[<span style="color: #e6db74;">'records'</span>])

<span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">PostgreSQLConnector</span>(SourceConnector):
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">connect</span>(self, connection_string, credentials_key):
        <span style="color: #66d9ef;">import</span> psycopg2
        creds = self._get_credentials(credentials_key)
        self.conn = psycopg2.connect(connection_string)
        <span style="color: #66d9ef;">return</span> self.conn

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">extract</span>(self, table_name, watermark=<span style="color: #66d9ef;">None</span>):
        query = <span style="color: #e6db74;">f"SELECT * FROM {table_name}"</span>
        <span style="color: #66d9ef;">if</span> watermark:
            query += <span style="color: #e6db74;">f" WHERE updated_at > '{watermark}'"</span>
        <span style="color: #66d9ef;">return</span> pd.read_sql(query, self.conn)</pre>
          </div>
        </div>
      </div>

      <!-- Customization Guide -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #667eea; margin-bottom: 20px;"><i class="fas fa-sliders-h"></i> Customization & Extensions</h3>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px;">
            <h4 style="color: #667eea; margin-bottom: 12px;"><i class="fas fa-plug"></i> Add New Connectors</h4>
            <p style="color: #555; line-height: 1.7; margin-bottom: 12px;">Extend support for additional data sources:</p>
            <ul style="color: #555; line-height: 1.7; margin-left: 20px;">
              <li>Implement the <code>SourceConnector</code> interface</li>
              <li>Register in the connector registry</li>
              <li>Add metadata entries for new sources</li>
            </ul>
          </div>

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px;">
            <h4 style="color: #764ba2; margin-bottom: 12px;"><i class="fas fa-cogs"></i> Custom Transformations</h4>
            <p style="color: #555; line-height: 1.7; margin-bottom: 12px;">Add transformation logic:</p>
            <ul style="color: #555; line-height: 1.7; margin-left: 20px;">
              <li>Store SQL/Python scripts in metadata</li>
              <li>Use UDFs for complex transformations</li>
              <li>Chain multiple transformation steps</li>
            </ul>
          </div>

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px;">
            <h4 style="color: #9c27b0; margin-bottom: 12px;"><i class="fas fa-shield-alt"></i> Data Quality Rules</h4>
            <p style="color: #555; line-height: 1.7; margin-bottom: 12px;">Implement validation logic:</p>
            <ul style="color: #555; line-height: 1.7; margin-left: 20px;">
              <li>Define rules in JSON format</li>
              <li>Integrate Great Expectations</li>
              <li>Configure quarantine strategies</li>
            </ul>
          </div>

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px;">
            <h4 style="color: #4caf50; margin-bottom: 12px;"><i class="fas fa-chart-line"></i> Monitoring & Alerting</h4>
            <p style="color: #555; line-height: 1.7; margin-bottom: 12px;">Track pipeline health:</p>
            <ul style="color: #555; line-height: 1.7; margin-left: 20px;">
              <li>Log execution metrics to metadata</li>
              <li>Set up alerts for failures</li>
              <li>Create dashboards for observability</li>
            </ul>
          </div>

        </div>
      </div>

      <!-- Best Practices -->
      <div style="background: #fff3e0; border-left: 4px solid #ff9800; padding: 25px; border-radius: 8px;">
        <h4 style="color: #e65100; margin-bottom: 15px;"><i class="fas fa-star"></i> Best Practices</h4>
        <ul style="color: #555; line-height: 1.8;">
          <li><strong>Version Control:</strong> Track metadata table changes using database migration tools (Flyway, Liquibase)</li>
          <li><strong>Idempotency:</strong> Ensure pipeline runs are idempotent using upsert operations</li>
          <li><strong>Error Handling:</strong> Implement retry logic with exponential backoff</li>
          <li><strong>Secrets Management:</strong> Never hardcode credentials; always use vault systems</li>
          <li><strong>Testing:</strong> Create test metadata entries for CI/CD validation</li>
        </ul>
      </div>
    </section>

    <!-- ETLT/ELTL++ Implementation Guide -->
    <section id="etlt-guide" style="padding: 60px 20px; max-width: 1200px; margin: 0 auto; background: #f9f9f9;">
      <div style="background: linear-gradient(135deg, #ff6b6b 0%, #7c4dff 100%); color: white; padding: 40px; border-radius: 15px; margin-bottom: 40px;">
        <h2 style="font-size: 2.5rem; margin-bottom: 15px;"><i class="fas fa-sync-alt"></i> ETLT/ELTL++ Implementation</h2>
        <p style="font-size: 1.2rem; line-height: 1.8;">Implement production-grade transformation patterns with data contracts, quarantine layers, and time travel capabilities.</p>
      </div>

      <!-- GitHub Repository Reference -->
      <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 25px; border-radius: 8px; margin-bottom: 30px;">
        <h4 style="color: #1565c0; margin-bottom: 15px;"><i class="fab fa-github"></i> Reference Implementation</h4>
        <p style="color: #555; line-height: 1.7; margin-bottom: 12px;">
          Complete validation framework available on GitHub:
        </p>
        <a href="https://github.com/ChiaraRucco/ETLT_DesignPattern_validation" target="_blank" style="display: inline-block; padding: 12px 25px; background: #2196f3; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
          <i class="fab fa-github"></i> View Repository
        </a>
      </div>

      <!-- Quick Start -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #ff6b6b; margin-bottom: 20px;"><i class="fas fa-rocket"></i> Quick Start</h3>

        <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem; margin-bottom: 20px;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># Clone the validation framework</span>
git clone https://github.com/ChiaraRucco/ETLT_DesignPattern_validation.git
cd ETLT_DesignPattern_validation

<span style="color: #75715e;"># Install dependencies</span>
pip install pandas pyarrow deltalake great-expectations faker sqlalchemy duckdb matplotlib seaborn

<span style="color: #75715e;"># Run all validation experiments</span>
python run_all_experiments.py

<span style="color: #75715e;"># Results will be generated in ./results/ directory</span></pre>
        </div>

        <div style="background: #f5f7fa; padding: 20px; border-radius: 8px;">
          <h4 style="color: #333; margin-bottom: 12px;">Repository Structure</h4>
          <div style="background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; font-size: 0.85rem;">
<pre style="margin: 0;">experiments/
├── 1_data_generation.py     <span style="color: #75715e;"># TPC-H synthetic dataset</span>
├── 2_data_quality.py        <span style="color: #75715e;"># Contract validation</span>
├── 3_time_travel.py         <span style="color: #75715e;"># Delta Lake versioning</span>
├── 4_performance.py         <span style="color: #75715e;"># Benchmark comparisons</span>
└── 5_cost_analysis.py       <span style="color: #75715e;"># Cost modeling</span></pre>
          </div>
        </div>
      </div>

      <!-- ETLT++ Implementation -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #ff6b6b; margin-bottom: 20px;"><i class="fas fa-filter"></i> ETLT++ Implementation</h3>

        <p style="color: #555; line-height: 1.7; margin-bottom: 20px;">
          ETLT++ validates and transforms data <strong>before</strong> storage, rejecting invalid records to a quarantine layer.
        </p>

        <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #66d9ef;">import</span> great_expectations <span style="color: #66d9ef;">as</span> gx
<span style="color: #66d9ef;">from</span> deltalake <span style="color: #66d9ef;">import</span> DeltaTable
<span style="color: #66d9ef;">import</span> pandas <span style="color: #66d9ef;">as</span> pd

<span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">ETLTPlusPipeline</span>:
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">__init__</span>(self, data_contract_path):
        self.context = gx.get_context()
        self.contract = self._load_contract(data_contract_path)

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">extract</span>(self, source):
        <span style="color: #e6db74;">"""Extract data from source"""</span>
        <span style="color: #66d9ef;">return</span> pd.read_csv(source)  <span style="color: #75715e;"># or any source connector</span>

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">transform_quality</span>(self, data):
        <span style="color: #e6db74;">"""Transform₁: Validate against data contract"""</span>

        <span style="color: #75715e;"># Validate using Great Expectations</span>
        batch = self.context.sources.pandas_default.read_dataframe(data)
        results = batch.validate(self.contract)

        <span style="color: #75715e;"># Separate valid and invalid records</span>
        valid_data = data[results.success_index]
        invalid_data = data[~results.success_index]

        <span style="color: #75715e;"># Add metadata to invalid records</span>
        invalid_data[<span style="color: #e6db74;">'rejection_reason'</span>] = results.failure_reasons
        invalid_data[<span style="color: #e6db74;">'rejection_timestamp'</span>] = pd.Timestamp.now()
        invalid_data[<span style="color: #e6db74;">'batch_id'</span>] = self._get_batch_id()

        <span style="color: #66d9ef;">return</span> valid_data, invalid_data

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">load</span>(self, valid_data, invalid_data):
        <span style="color: #e6db74;">"""Load validated data to warehouse, quarantine invalids"""</span>

        <span style="color: #75715e;"># Load valid data to main table</span>
        valid_data.to_parquet(<span style="color: #e6db74;">'warehouse/validated_data.parquet'</span>)

        <span style="color: #75715e;"># Load invalid data to quarantine (Delta Lake for replay)</span>
        invalid_data.to_parquet(<span style="color: #e6db74;">'quarantine/failed_records/'</span>)

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">transform_business</span>(self, data):
        <span style="color: #e6db74;">"""Transform₂: Apply business logic on validated data"""</span>

        <span style="color: #75715e;"># Example: Enrichment</span>
        data[<span style="color: #e6db74;">'processed_date'</span>] = pd.Timestamp.now()
        data[<span style="color: #e6db74;">'data_quality_score'</span>] = <span style="color: #ae81ff;">100.0</span>

        <span style="color: #66d9ef;">return</span> data

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">run</span>(self, source):
        <span style="color: #75715e;"># ETLT++ Pipeline: E → T₁ → L → T₂</span>
        raw_data = self.extract(source)
        valid, invalid = self.transform_quality(raw_data)
        self.load(valid, invalid)
        transformed = self.transform_business(valid)
        <span style="color: #66d9ef;">return</span> transformed</pre>
        </div>

        <div style="margin-top: 20px; background: #e8f5e9; padding: 15px; border-radius: 5px;">
          <p style="color: #2e7d32; margin: 0;"><i class="fas fa-check-circle"></i> <strong>Key Features:</strong> Data contracts enforce quality at ingestion, quarantine enables replay after fixes, only clean data enters warehouse.</p>
        </div>
      </div>

      <!-- ELTL++ Implementation -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #7c4dff; margin-bottom: 20px;"><i class="fas fa-database"></i> ELTL++ Implementation</h3>

        <p style="color: #555; line-height: 1.7; margin-bottom: 20px;">
          ELTL++ loads <strong>all</strong> data first (including invalid records) to enable time travel and reprocessing.
        </p>

        <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #66d9ef;">from</span> deltalake <span style="color: #66d9ef;">import</span> write_deltalake, DeltaTable
<span style="color: #66d9ef;">import</span> pyarrow <span style="color: #66d9ef;">as</span> pa

<span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">ELTLPlusPipeline</span>:
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">__init__</span>(self, bronze_path, silver_path, gold_path):
        self.bronze = bronze_path
        self.silver = silver_path
        self.gold = gold_path

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">extract</span>(self, source):
        <span style="color: #e6db74;">"""Extract from source"""</span>
        <span style="color: #66d9ef;">return</span> pd.read_csv(source)

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">load_raw</span>(self, data):
        <span style="color: #e6db74;">"""Load₁: Store ALL data in Bronze (raw) layer"""</span>

        <span style="color: #75715e;"># Add ingestion metadata</span>
        data[<span style="color: #e6db74;">'_ingestion_timestamp'</span>] = pd.Timestamp.now()
        data[<span style="color: #e6db74;">'_source_file'</span>] = self._get_source_id()
        data[<span style="color: #e6db74;">'_schema_version'</span>] = self._get_schema_version()

        <span style="color: #75715e;"># Write to Delta Lake for versioning</span>
        write_deltalake(
            self.bronze,
            data,
            mode=<span style="color: #e6db74;">"append"</span>,
            schema_mode=<span style="color: #e6db74;">"merge"</span>,  <span style="color: #75715e;"># Handle schema evolution</span>
            partition_by=[<span style="color: #e6db74;">"_ingestion_date"</span>]
        )

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">transform_and_load</span>(self):
        <span style="color: #e6db74;">"""Transform: Quality + Business, Load₂: Curated layers"""</span>

        <span style="color: #75715e;"># Read from Bronze</span>
        bronze_table = DeltaTable(self.bronze)
        raw_data = bronze_table.to_pandas()

        <span style="color: #75715e;"># Silver: Cleansed and validated data</span>
        silver_data = self._cleanse_data(raw_data)
        silver_data[<span style="color: #e6db74;">'_quality_checked'</span>] = <span style="color: #66d9ef;">True</span>
        write_deltalake(self.silver, silver_data, mode=<span style="color: #e6db74;">"overwrite"</span>)

        <span style="color: #75715e;"># Gold: Business-transformed data</span>
        gold_data = self._apply_business_logic(silver_data)
        write_deltalake(self.gold, gold_data, mode=<span style="color: #e6db74;">"overwrite"</span>)

        <span style="color: #66d9ef;">return</span> gold_data

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">time_travel_query</span>(self, version=<span style="color: #66d9ef;">None</span>, timestamp=<span style="color: #66d9ef;">None</span>):
        <span style="color: #e6db74;">"""Query historical data state"""</span>
        dt = DeltaTable(self.bronze)

        <span style="color: #66d9ef;">if</span> version:
            <span style="color: #66d9ef;">return</span> dt.load_version(version).to_pandas()
        <span style="color: #66d9ef;">elif</span> timestamp:
            <span style="color: #66d9ef;">return</span> dt.load_as_of_datetime(timestamp).to_pandas()
        <span style="color: #66d9ef;">else</span>:
            <span style="color: #66d9ef;">return</span> dt.to_pandas()

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">reprocess_historical_data</span>(self, start_date):
        <span style="color: #e6db74;">"""Reprocess raw data with updated transformation logic"""</span>

        <span style="color: #75715e;"># Get historical raw data</span>
        historical_data = self.time_travel_query(timestamp=start_date)

        <span style="color: #75715e;"># Apply NEW transformation logic without re-ingesting</span>
        updated_silver = self._cleanse_data(historical_data)
        updated_gold = self._apply_business_logic(updated_silver)

        <span style="color: #66d9ef;">return</span> updated_gold

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">run</span>(self, source):
        <span style="color: #75715e;"># ELTL++ Pipeline: E → L₁ (Bronze) → T → L₂ (Silver/Gold)</span>
        raw_data = self.extract(source)
        self.load_raw(raw_data)
        curated_data = self.transform_and_load()
        <span style="color: #66d9ef;">return</span> curated_data</pre>
        </div>

        <div style="margin-top: 20px; background: #f3e5f5; padding: 15px; border-radius: 5px;">
          <p style="color: #6a1b9a; margin: 0;"><i class="fas fa-history"></i> <strong>Key Features:</strong> Complete raw data preservation, time travel queries, reprocess without re-ingestion, multi-zone architecture (Bronze/Silver/Gold).</p>
        </div>
      </div>

      <!-- Validation Framework -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #ff6b6b; margin-bottom: 20px;"><i class="fas fa-vial"></i> Running the Validation Framework</h3>

        <p style="color: #555; line-height: 1.7; margin-bottom: 20px;">
          The validation framework provides 5 experiments to verify ETLT/ELTL++ patterns:
        </p>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">

          <div style="background: #e3f2fd; padding: 20px; border-radius: 8px; border-left: 4px solid #2196f3;">
            <h4 style="color: #1565c0; margin-bottom: 10px;">1. Data Generation</h4>
            <p style="color: #555; font-size: 0.9rem; line-height: 1.6;">Generates TPC-H synthetic dataset with controlled quality issues</p>
          </div>

          <div style="background: #f3e5f5; padding: 20px; border-radius: 8px; border-left: 4px solid #9c27b0;">
            <h4 style="color: #6a1b9a; margin-bottom: 10px;">2. Data Quality</h4>
            <p style="color: #555; font-size: 0.9rem; line-height: 1.6;">Validates data contracts using Great Expectations</p>
          </div>

          <div style="background: #fff3e0; padding: 20px; border-radius: 8px; border-left: 4px solid #ff9800;">
            <h4 style="color: #e65100; margin-bottom: 10px;">3. Time Travel</h4>
            <p style="color: #555; font-size: 0.9rem; line-height: 1.6;">Tests Delta Lake versioning and historical queries</p>
          </div>

          <div style="background: #e8f5e9; padding: 20px; border-radius: 8px; border-left: 4px solid #4caf50;">
            <h4 style="color: #2e7d32; margin-bottom: 10px;">4. Performance</h4>
            <p style="color: #555; font-size: 0.9rem; line-height: 1.6;">Benchmarks ETLT++ vs ELTL++ processing speed</p>
          </div>

          <div style="background: #fce4ec; padding: 20px; border-radius: 8px; border-left: 4px solid #e91e63; grid-column: span 2;">
            <h4 style="color: #c2185b; margin-bottom: 10px;">5. Cost Analysis</h4>
            <p style="color: #555; font-size: 0.9rem; line-height: 1.6;">Models storage and compute costs for tiered architecture (40-50% reduction)</p>
          </div>

        </div>

        <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># Run specific experiment</span>
python experiments/1_data_generation.py
python experiments/2_data_quality.py

<span style="color: #75715e;"># Or run all experiments</span>
python run_all_experiments.py

<span style="color: #75715e;"># Check results</span>
ls -la results/
<span style="color: #75715e;"># ├── data_quality_report.json</span>
<span style="color: #75715e;"># ├── performance_benchmark.json</span>
<span style="color: #75715e;"># ├── cost_analysis.json</span>
<span style="color: #75715e;"># └── validation_summary.json</span></pre>
        </div>
      </div>

      <!-- Customization Tips -->
      <div style="background: #fff9c4; border-left: 4px solid #fbc02d; padding: 25px; border-radius: 8px;">
        <h4 style="color: #f57f17; margin-bottom: 15px;"><i class="fas fa-wrench"></i> Customization Tips</h4>
        <ul style="color: #555; line-height: 1.8;">
          <li><strong>Data Contracts:</strong> Customize expectations in Great Expectations suite for your schema</li>
          <li><strong>Storage Format:</strong> Switch between Parquet, Delta Lake, or Apache Iceberg based on requirements</li>
          <li><strong>Quarantine Strategy:</strong> Configure retention policies and replay mechanisms</li>
          <li><strong>Multi-tenancy:</strong> Implement team-specific transformation branches in ELTL++</li>
          <li><strong>Schema Evolution:</strong> Use Delta Lake's schema merge mode for backward compatibility</li>
        </ul>
      </div>
    </section>

    <!-- EADF Implementation Guide -->
    <section id="eadf-guide" style="padding: 60px 20px; max-width: 1200px; margin: 0 auto;">
      <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 40px; border-radius: 15px; margin-bottom: 40px;">
        <h2 style="font-size: 2.5rem; margin-bottom: 15px;"><i class="fas fa-cloud"></i> EADF Implementation</h2>
        <p style="font-size: 1.2rem; line-height: 1.8;">Build cloud-agnostic CI/CD pipelines with environment-aware late binding for multi-environment deployments.</p>
      </div>

      <!-- GitHub Repository Reference -->
      <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 25px; border-radius: 8px; margin-bottom: 30px;">
        <h4 style="color: #1565c0; margin-bottom: 15px;"><i class="fab fa-github"></i> Reference Implementation</h4>
        <p style="color: #555; line-height: 1.7; margin-bottom: 12px;">
          Complete validation framework and CI/CD templates:
        </p>
        <a href="https://github.com/ChiaraRucco/CICD_DesignPattern_Validation" target="_blank" style="display: inline-block; padding: 12px 25px; background: #2196f3; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
          <i class="fab fa-github"></i> View Repository
        </a>
      </div>

      <!-- Core Concepts -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #4facfe; margin-bottom: 20px;"><i class="fas fa-lightbulb"></i> Core Concepts</h3>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px; border-left: 4px solid #4facfe;">
            <h4 style="color: #4facfe; margin-bottom: 12px;">Late Binding</h4>
            <p style="color: #555; line-height: 1.7;">Environment parameters are bound at <strong>deployment time</strong>, not authoring time. This enables a single artifact to be promoted across dev → staging → prod.</p>
          </div>

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px; border-left: 4px solid #00bcd4;">
            <h4 style="color: #00bcd4; margin-bottom: 12px;">YAML Artifacts</h4>
            <p style="color: #555; line-height: 1.7;">Four declarative YAML files define components, environments, pipelines, and promotion rules—separating logic from configuration.</p>
          </div>

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px; border-left: 4px solid #9c27b0;">
            <h4 style="color: #9c27b0; margin-bottom: 12px;">7-Stage Pipeline</h4>
            <p style="color: #555; line-height: 1.7;">Binding → Build → Validation → Deployment → Smoke Test → Gate Evaluation → Provenance ensures quality at each stage.</p>
          </div>

          <div style="background: #f5f7fa; padding: 20px; border-radius: 8px; border-left: 4px solid #ff9800;">
            <h4 style="color: #ff9800; margin-bottom: 12px;">Cloud Agnostic</h4>
            <p style="color: #555; line-height: 1.7;">Same pipeline definition works across Azure, AWS, and GCP with environment-specific bindings.</p>
          </div>

        </div>
      </div>

      <!-- YAML Artifacts Setup -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #4facfe; margin-bottom: 20px;"><i class="fas fa-file-code"></i> Step 1: Define YAML Artifacts</h3>

        <!-- component.yaml -->
        <div style="margin-bottom: 25px;">
          <h4 style="color: #2196f3; margin-bottom: 12px;">component.yaml - Define Your Artifact</h4>
          <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.85rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># component.yaml</span>
<span style="color: #66d9ef;">name:</span> customer_orders_pipeline
<span style="color: #66d9ef;">type:</span> adf_pipeline              <span style="color: #75715e;"># or databricks_notebook, synapse_pipeline</span>
<span style="color: #66d9ef;">version:</span> <span style="color: #e6db74;">"1.2.0"</span>
<span style="color: #66d9ef;">artifact:</span> ./artifacts/adf/customer_orders.json

<span style="color: #66d9ef;">params:</span>
  <span style="color: #66d9ef;">schedule:</span> <span style="color: #e6db74;">"0 2 * * *"</span>         <span style="color: #75715e;"># Daily at 2 AM</span>
  <span style="color: #66d9ef;">tags:</span>
    - ingestion
    - orders
    - critical
  <span style="color: #66d9ef;">dependencies:</span>
    - reference_data_pipeline</pre>
          </div>
        </div>

        <!-- environments.yaml -->
        <div style="margin-bottom: 25px;">
          <h4 style="color: #9c27b0; margin-bottom: 12px;">environments.yaml - Define Environments</h4>
          <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.85rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># environments.yaml</span>
<span style="color: #66d9ef;">environments:</span>
  - <span style="color: #66d9ef;">name:</span> dev
    <span style="color: #66d9ef;">cloud:</span> azure
    <span style="color: #66d9ef;">region:</span> westeurope
    <span style="color: #66d9ef;">resource_group:</span> rg-dataeng-dev
    <span style="color: #66d9ef;">data_factory:</span> adf-customer-dev
    <span style="color: #66d9ef;">storage_account:</span> stgcustomerdev
    <span style="color: #66d9ef;">key_vault:</span> kv-customer-dev
    <span style="color: #66d9ef;">linked_services:</span>
      <span style="color: #66d9ef;">source_db:</span> <span style="color: #e6db74;">"{{vault.dev_db_connection}}"</span>
      <span style="color: #66d9ef;">target_dw:</span> <span style="color: #e6db74;">"{{vault.dev_dw_connection}}"</span>

  - <span style="color: #66d9ef;">name:</span> staging
    <span style="color: #66d9ef;">cloud:</span> azure
    <span style="color: #66d9ef;">region:</span> westeurope
    <span style="color: #66d9ef;">resource_group:</span> rg-dataeng-staging
    <span style="color: #66d9ef;">data_factory:</span> adf-customer-staging
    <span style="color: #66d9ef;">storage_account:</span> stgcustomerstaging
    <span style="color: #66d9ef;">key_vault:</span> kv-customer-staging
    <span style="color: #66d9ef;">linked_services:</span>
      <span style="color: #66d9ef;">source_db:</span> <span style="color: #e6db74;">"{{vault.staging_db_connection}}"</span>
      <span style="color: #66d9ef;">target_dw:</span> <span style="color: #e6db74;">"{{vault.staging_dw_connection}}"</span>

  - <span style="color: #66d9ef;">name:</span> prod
    <span style="color: #66d9ef;">cloud:</span> azure
    <span style="color: #66d9ef;">region:</span> northeurope          <span style="color: #75715e;"># Different region for prod</span>
    <span style="color: #66d9ef;">resource_group:</span> rg-dataeng-prod
    <span style="color: #66d9ef;">data_factory:</span> adf-customer-prod
    <span style="color: #66d9ef;">storage_account:</span> stgcustomerprod
    <span style="color: #66d9ef;">key_vault:</span> kv-customer-prod
    <span style="color: #66d9ef;">linked_services:</span>
      <span style="color: #66d9ef;">source_db:</span> <span style="color: #e6db74;">"{{vault.prod_db_connection}}"</span>
      <span style="color: #66d9ef;">target_dw:</span> <span style="color: #e6db74;">"{{vault.prod_dw_connection}}"</span></pre>
          </div>
        </div>

        <!-- pipeline.yaml -->
        <div style="margin-bottom: 25px;">
          <h4 style="color: #ff9800; margin-bottom: 12px;">pipeline.yaml - Define Deployment Pipeline</h4>
          <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.85rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># pipeline.yaml</span>
<span style="color: #66d9ef;">name:</span> customer_orders_cicd
<span style="color: #66d9ef;">trigger:</span>
  <span style="color: #66d9ef;">branch:</span> main
  <span style="color: #66d9ef;">paths:</span>
    - artifacts/adf/**
    - component.yaml

<span style="color: #66d9ef;">stages:</span>
  - <span style="color: #66d9ef;">stage:</span> binding
    <span style="color: #66d9ef;">steps:</span>
      - <span style="color: #66d9ef;">name:</span> resolve_parameters
        <span style="color: #66d9ef;">script:</span> python eadf_core/binding.py --env <span style="color: #e6db74;">"{{target_env}}"</span>

  - <span style="color: #66d9ef;">stage:</span> build
    <span style="color: #66d9ef;">steps:</span>
      - <span style="color: #66d9ef;">name:</span> package_artifact
        <span style="color: #66d9ef;">script:</span> python eadf_core/build.py

  - <span style="color: #66d9ef;">stage:</span> validation
    <span style="color: #66d9ef;">steps:</span>
      - <span style="color: #66d9ef;">name:</span> lint_json
        <span style="color: #66d9ef;">script:</span> jsonlint artifacts/**/*.json
      - <span style="color: #66d9ef;">name:</span> validate_schema
        <span style="color: #66d9ef;">script:</span> python eadf_core/validate_schema.py

  - <span style="color: #66d9ef;">stage:</span> deploy
    <span style="color: #66d9ef;">environment:</span> <span style="color: #e6db74;">"{{target_env}}"</span>
    <span style="color: #66d9ef;">steps:</span>
      - <span style="color: #66d9ef;">name:</span> deploy_to_adf
        <span style="color: #66d9ef;">script:</span> az datafactory pipeline create-or-update

  - <span style="color: #66d9ef;">stage:</span> smoke_test
    <span style="color: #66d9ef;">steps:</span>
      - <span style="color: #66d9ef;">name:</span> run_test_batch
        <span style="color: #66d9ef;">script:</span> python tests/smoke_test.py

  - <span style="color: #66d9ef;">stage:</span> gate_evaluation
    <span style="color: #66d9ef;">approval:</span> required_for_prod
    <span style="color: #66d9ef;">checks:</span>
      - smoke_tests_passed
      - data_quality_score > <span style="color: #ae81ff;">95</span>

  - <span style="color: #66d9ef;">stage:</span> provenance
    <span style="color: #66d9ef;">steps:</span>
      - <span style="color: #66d9ef;">name:</span> log_deployment
        <span style="color: #66d9ef;">script:</span> python eadf_core/provenance.py</pre>
          </div>
        </div>

        <!-- promotion.yaml -->
        <div>
          <h4 style="color: #4caf50; margin-bottom: 12px;">promotion.yaml - Define Promotion Rules</h4>
          <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.85rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># promotion.yaml</span>
<span style="color: #66d9ef;">promotion_rules:</span>
  - <span style="color: #66d9ef;">from:</span> dev
    <span style="color: #66d9ef;">to:</span> staging
    <span style="color: #66d9ef;">conditions:</span>
      - all_tests_passed
      - code_review_approved
    <span style="color: #66d9ef;">automatic:</span> <span style="color: #66d9ef;">true</span>

  - <span style="color: #66d9ef;">from:</span> staging
    <span style="color: #66d9ef;">to:</span> prod
    <span style="color: #66d9ef;">conditions:</span>
      - staging_running_for: 24h
      - smoke_tests_passed
      - manual_approval_required
    <span style="color: #66d9ef;">automatic:</span> <span style="color: #66d9ef;">false</span>
    <span style="color: #66d9ef;">approvers:</span>
      - data_engineering_lead
      - platform_architect</pre>
          </div>
        </div>
      </div>

      <!-- Implementation Script -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #4facfe; margin-bottom: 20px;"><i class="fas fa-cogs"></i> Step 2: Implement Binding Logic</h3>

        <p style="color: #555; line-height: 1.7; margin-bottom: 20px;">
          The binding stage resolves environment-specific parameters at deployment time:
        </p>

        <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># eadf_core/binding.py</span>
<span style="color: #66d9ef;">import</span> yaml
<span style="color: #66d9ef;">import</span> re
<span style="color: #66d9ef;">from</span> azure.keyvault.secrets <span style="color: #66d9ef;">import</span> SecretClient

<span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">ParameterBinder</span>:
    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">__init__</span>(self, environments_file, component_file):
        <span style="color: #66d9ef;">with</span> <span style="color: #a6e22e;">open</span>(environments_file) <span style="color: #66d9ef;">as</span> f:
            self.environments = yaml.safe_load(f)[<span style="color: #e6db74;">'environments'</span>]
        <span style="color: #66d9ef;">with</span> <span style="color: #a6e22e;">open</span>(component_file) <span style="color: #66d9ef;">as</span> f:
            self.component = yaml.safe_load(f)

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">bind</span>(self, target_env):
        <span style="color: #e6db74;">"""Resolve all {{placeholders}} for target environment"""</span>

        <span style="color: #75715e;"># Get environment config</span>
        env_config = <span style="color: #a6e22e;">next</span>(e <span style="color: #66d9ef;">for</span> e <span style="color: #66d9ef;">in</span> self.environments <span style="color: #66d9ef;">if</span> e[<span style="color: #e6db74;">'name'</span>] == target_env)

        <span style="color: #75715e;"># Load artifact template</span>
        <span style="color: #66d9ef;">with</span> <span style="color: #a6e22e;">open</span>(self.component[<span style="color: #e6db74;">'artifact'</span>]) <span style="color: #66d9ef;">as</span> f:
            artifact = f.read()

        <span style="color: #75715e;"># Resolve environment variables</span>
        artifact = self._resolve_env_vars(artifact, env_config)

        <span style="color: #75715e;"># Resolve vault secrets</span>
        artifact = self._resolve_vault_secrets(artifact, env_config[<span style="color: #e6db74;">'key_vault'</span>])

        <span style="color: #66d9ef;">return</span> artifact

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">_resolve_env_vars</span>(self, artifact, env_config):
        <span style="color: #e6db74;">"""Replace {{env.key}} with environment values"""</span>
        <span style="color: #66d9ef;">for</span> key, value <span style="color: #66d9ef;">in</span> env_config.items():
            pattern = <span style="color: #e6db74;">f"</span><span style="color: #e6db74;">{{</span><span style="color: #e6db74;">{{env.</span><span style="color: #e6db74;">{key}</span><span style="color: #e6db74;">}}}}</span><span style="color: #e6db74;">"</span>
            artifact = artifact.replace(pattern, <span style="color: #a6e22e;">str</span>(value))
        <span style="color: #66d9ef;">return</span> artifact

    <span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">_resolve_vault_secrets</span>(self, artifact, vault_name):
        <span style="color: #e6db74;">"""Replace {{vault.secret_name}} with actual secrets"""</span>
        vault_client = SecretClient(vault_url=<span style="color: #e6db74;">f"https://</span><span style="color: #e6db74;">{vault_name}</span><span style="color: #e6db74;">.vault.azure.net"</span>)

        <span style="color: #75715e;"># Find all vault placeholders</span>
        vault_refs = re.findall(<span style="color: #e6db74;">r'{{vault\.(\w+)}}'</span>, artifact)

        <span style="color: #66d9ef;">for</span> secret_name <span style="color: #66d9ef;">in</span> vault_refs:
            secret_value = vault_client.get_secret(secret_name).value
            artifact = artifact.replace(<span style="color: #e6db74;">f"{{{{vault.</span><span style="color: #e6db74;">{secret_name}</span><span style="color: #e6db74;">}}}}"</span>, secret_value)

        <span style="color: #66d9ef;">return</span> artifact

<span style="color: #75715e;"># Usage</span>
binder = ParameterBinder(<span style="color: #e6db74;">'environments.yaml'</span>, <span style="color: #e6db74;">'component.yaml'</span>)
bound_artifact = binder.bind(target_env=<span style="color: #e6db74;">'prod'</span>)</pre>
        </div>
      </div>

      <!-- Running the Framework -->
      <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #4facfe; margin-bottom: 20px;"><i class="fas fa-rocket"></i> Step 3: Run the Pipeline</h3>

        <div style="background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<pre style="margin: 0; color: #f8f8f2;"><span style="color: #75715e;"># Clone the validation framework</span>
git clone https://github.com/ChiaraRucco/CICD_DesignPattern_Validation.git
cd CICD_DesignPattern_Validation

<span style="color: #75715e;"># Install dependencies</span>
pip install -r requirements.txt

<span style="color: #75715e;"># Run all validation experiments</span>
python run_all_experiments.py

<span style="color: #75715e;"># Deploy to specific environment</span>
python eadf_core/deploy.py --env dev --component customer_orders_pipeline

<span style="color: #75715e;"># Promote from staging to prod</span>
python eadf_core/promote.py --from staging --to prod --component customer_orders_pipeline</pre>
        </div>
      </div>

      <!-- Benefits -->
      <div style="background: #e8f5e9; border-left: 4px solid #4caf50; padding: 25px; border-radius: 8px;">
        <h4 style="color: #2e7d32; margin-bottom: 15px;"><i class="fas fa-check-circle"></i> Key Benefits of EADF</h4>
        <ul style="color: #555; line-height: 1.8;">
          <li><strong>Cloud Agnostic:</strong> Same pipeline works on Azure, AWS, and GCP</li>
          <li><strong>No Code Duplication:</strong> Single artifact promoted across all environments</li>
          <li><strong>Drift Prevention:</strong> Declarative configuration prevents environment drift</li>
          <li><strong>Fast Deployment:</strong> Late binding reduces deployment time significantly</li>
          <li><strong>Audit Trail:</strong> Complete provenance tracking of all deployments</li>
        </ul>
      </div>
    </section>

    <!-- Additional Resources -->
    <section style="padding: 60px 20px; background: #f5f7fa;">
      <div style="max-width: 1200px; margin: 0 auto;">
        <h2 style="text-align: center; margin-bottom: 40px; color: #333;"><i class="fas fa-book"></i> Additional Resources</h2>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">

          <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <h4 style="color: #667eea; margin-bottom: 15px;"><i class="fab fa-github"></i> GitHub Repositories</h4>
            <ul style="color: #555; line-height: 2;">
              <li><a href="https://github.com/ChiaraRucco/ETLT_DesignPattern_validation" target="_blank" style="color: #2196f3;">ETLT++ Validation</a></li>
              <li><a href="https://github.com/ChiaraRucco/CICD_DesignPattern_Validation" target="_blank" style="color: #2196f3;">EADF Validation</a></li>
            </ul>
          </div>

          <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <h4 style="color: #9c27b0; margin-bottom: 15px;"><i class="fas fa-book-open"></i> Documentation</h4>
            <ul style="color: #555; line-height: 2;">
              <li><a href="mind.html" style="color: #2196f3;">MIND Pattern Details</a></li>
              <li><a href="etlt.html" style="color: #2196f3;">ETLT/ELTL++ Details</a></li>
              <li><a href="eadf.html" style="color: #2196f3;">EADF Details</a></li>
            </ul>
          </div>

          <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <h4 style="color: #ff9800; margin-bottom: 15px;"><i class="fas fa-hands-helping"></i> Community</h4>
            <p style="color: #555; line-height: 1.7;">Join discussions, contribute improvements, and share your implementations.</p>
          </div>

        </div>
      </div>
    </section>

  </main>

  <footer style="background: #1a1a1a; border-top: 1px solid #333; padding: 30px 20px; color: #999;">
    <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
      <p style="margin: 0; font-size: 0.9rem;">&copy; 2025 DataLab - University of Salento. All rights reserved.</p>
    </div>
  </footer>

  <style>
    * {
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .nav-link:hover {
      color: #fff !important;
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-1px);
    }

    .github-link:hover {
      background: #2ea44f;
      color: white !important;
    }

    .nav-link:active {
      transform: translateY(0);
    }

    button {
      transition: all 0.2s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    button:active {
      transform: translateY(0);
    }

    a[href^="#"] {
      scroll-behavior: smooth;
    }

    a[href^="#"]:hover div {
      transform: translateY(-5px);
      transition: transform 0.3s ease;
    }

    code {
      background: #f5f5f5;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'JetBrains Mono', 'Courier New', monospace;
      font-size: 0.9em;
      color: #d32f2f;
    }

    pre code {
      background: transparent;
      padding: 0;
      color: inherit;
    }

    @media (max-width: 768px) {
      header nav {
        flex-wrap: wrap;
        gap: 15px;
      }

      section > div {
        padding: 0 15px;
      }

      h2 {
        font-size: 1.5rem !important;
      }
    }
  </style>
</body>
</html>
